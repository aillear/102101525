# 一个小爬虫

基于`python`的小爬虫, 用于提取`bilibiili`的视频弹幕并加以简单的处理以及可视化。

具体应该实现的功能：

- 数据获取
- 数据分析
- 可视化

## 数据获取部分:

数据获取模块有以下几个功能：

- 根据用户输入的关键字以及需要的视频个数爬取相关视频的`BV`号
- 根据*BV*号获取相关视频的*cid*
- 根据*cid*获取相关视频的当前弹幕池
- 最后汇总各个视频的弹幕池，形成一个字符串列表

---

#### *BV*号获取：`BVFinder(_keyword: str, _video_count: int)`

- [x] 是否完成

- 功能实现：通过关键词获取前n页的相关视频*BV*号, 返回*BV*号的字符串列表
- 参数：
  - _keyword: 关键词
  - _video_count: 读取的视频数量
- 返回值： 获取的*BV*号字符串列表



#### *cid*获取： `CidReader(_bv: str)`

- [x] 是否完成

- 功能实现：读取BV号对应视频的cid
- 参数：_bv ： 视频*BV*号
- 返回值： 对应的*cid*



#### 弹幕池读取： `DanmakuReader(_cid: str)`

- [x] 是否完成

- 功能实现：根据cid读取当前视频弹幕池内弹幕
- 参数：cid ： cid
- 返回值： 弹幕字符串列表



#### 进一步封装：`DataCollect(_keyword: str, _video_count: int)`

- [x] 是否完成

- 功能实现： 封装本模块的功能
- 参数：
  - _keyword: 关键词
  - _video_count: 读取的视频数量
- 返回值：收集的弹幕列表





## 数据分析部分：

数据分析模块应该有以下几个功能：

- 进行简单的统计同类型弹幕个数，最后生成一个列表，列表的元素为一个元组,元组第一个元素为弹幕,第二个元素为出现次数。元组的排序按照次数从大到小
- 将上述列表保存为`.csv`文件，分为两列。每一行对应一条弹幕，第一列为弹幕数量，第二列为弹幕文本。按顺序从高到低排列。
- 将字符串列表组合成字符串并且分词，为接下来可视化做词云做准备

需要两个模块，一个负责写文件，另一个就是负责分析数据

---

#### 弹幕统计： `StrStatistics(_str_list: list[str])`

- [x] 是否完成

- 功能实现：统计传入的字符串列表中各个字符串出现的次数。返回列表元素为(string, int)样式的元组。
- 参数：_str_list： 字符串列表
- 返回值： 结果保存为特殊格式的列表



#### 文件保存： `List2CSV(_list: list[tuple[str, int]], _file_name: str)`

- [x] 是否完成

  - 功能实现：将列表按照某种规则存为`.CSV`文件。文件将保存在`DanmakuData`文件夹下

- 参数：
  - _list: 目标字典

  - _file_name： 保存的文件名

    



#### 分词：事实上，直接第三方库的接口就已经够方便了。不需要在进行封装了



## 数据可视化部分

- 通过数据分析部分得到的分词结果进行词云生成

---

#### 生成词云图：`CreateWordCloudImage(_content: str, _file_name: str, _max_words=100, _width=1000, _height=1000, _mask_name='default.png', _font_name='default.ttc')`

- [x] 是否完成

- 功能实现：创建词云图。遮罩图默认为空。此时长宽设置生效。自定义遮罩请放置在`ImageMasks`文件夹里；字体默认为微软雅黑。自定义字体请放在`Fonts`内。
- 参数：
  - _content: 分过词的内容
  - _file_name： 保存的词云图名
  - _max_words: 可以显示的最大词数
  - _width:  宽
  - _height: 高
  - _mask_name: 遮罩图片的名字
  - _font_name: 字体名

